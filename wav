#include <iostream>
#include <fstream>

using namespace std;

int main()
{
    // Open the file for binary input
    ifstream myfile("wave_sample.wav", ios::in | ios::binary);

    // Check if file was successfully opened
    if (!myfile)
    {
        cout << "Cannot read wave_sample\n";
        return 666;
    }

    // Read the first 44 bytes (header) of the WAV file
    char header[44];
    myfile.read(header, 44);

    // Get the sample rate from the header
    unsigned int* SampleRate = reinterpret_cast<unsigned int*>(header + 24);
    unsigned int sampleRateValue = *SampleRate;

    // Print the sample rate
    cout << "Sample rate: " << sampleRateValue << endl;

    short data[1000];

    myfile.read((char*)data, 1000);
    myfile.seekg(SampleRate[0] * 10);

    ofstream aaa("data.txt");
    if (!aaa) return 666;
    float dt = 1. / SampleRate[0];
    for (int i = 0; i < 500; i++) {
        // cout << i * dt << " " << data[i * 2] << data[i * 2 + 1] << endl;
        aaa << i * dt << " " << data[i * 2] << " " << data[i * 2 + 1] << endl;

    }
    aaa.close();

    // Close the file
    myfile.close();

    return 0;
}
